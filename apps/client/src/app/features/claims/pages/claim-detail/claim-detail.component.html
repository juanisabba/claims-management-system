<div class="container mx-auto p-4">
  @if (store.isLoading()) {
    <p class="text-gray-500">Loading...</p>
  }

  @if (store.error()) {
    <p class="text-red-500">{{ store.error() }}</p>
  }

  @if (store.claim(); as claim) {
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Claim Detail</h1>
      @if (claim.status === ClaimStatus.InReview) {
        <button
          (click)="onFinish()"
          [disabled]="!canFinish(claim)"
          class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Finish Claim
        </button>
      }
    </div>

    <div class="bg-white shadow overflow-hidden sm:rounded-lg mb-6">
      <div class="px-4 py-5 sm:px-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">{{ claim.title }}</h3>
        <p class="mt-1 max-w-2xl text-sm text-gray-500">{{ claim.description }}</p>
      </div>
      <div class="border-t border-gray-200">
        <dl>
          <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt class="text-sm font-medium text-gray-500">Status</dt>
            <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{{ claim.status }}</dd>
          </div>
          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt class="text-sm font-medium text-gray-500">Total Amount</dt>
            <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
              {{ store.totalAmount() | currency }}
            </dd>
          </div>
        </dl>
      </div>
    </div>

    <h2 class="text-xl font-bold mb-4">Damages</h2>

    <app-damage-list [damages]="claim.damages"></app-damage-list>

    <app-damage-form
      [claimStatus]="claim.status"
      (addDamage)="onAddDamage($event)"
    ></app-damage-form>
  }
</div>

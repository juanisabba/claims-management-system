<div class="bg-white rounded-lg shadow-md overflow-hidden">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          Part
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          Severity
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          Price
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          Actions
        </th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      @for (damage of damages(); track damage.id) {
        <tr class="hover:bg-gray-50 transition-colors">
          <td class="px-6 py-4 text-sm font-medium text-gray-900 max-w-md">
            <div class="flex items-center">
              <img
                [src]="damage.imageUrl"
                [alt]="damage.part"
                class="h-10 w-10 rounded-md object-cover mr-3 border border-gray-200 flex-shrink-0"
              />
              <span class="truncate" [title]="damage.part">{{ damage.part }}</span>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            <span
              [class]="getSeverityClass(damage.severity)"
              class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full"
            >
              {{ damage.severity | titlecase }}
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold">
            {{ damage.price | currency: 'EUR' }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
            <div class="flex space-x-3">
              @if (canEdit()) {
                <button
                  (click)="editDamage.emit(damage)"
                  class="text-amber-600 hover:text-amber-900 transition-colors"
                  title="Edit Damage"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="lucide lucide-pencil"
                  >
                    <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" />
                    <path d="m15 5 4 4" />
                  </svg>
                </button>
                <button
                  (click)="deleteDamage.emit(damage.id)"
                  class="text-red-600 hover:text-red-900 transition-colors"
                  title="Delete Damage"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="lucide lucide-trash-2"
                  >
                    <path d="M3 6h18" />
                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                    <line x1="10" x2="10" y1="11" y2="17" />
                    <line x1="14" x2="14" y1="11" y2="17" />
                  </svg>
                </button>
              } @else {
                <span class="text-gray-400 italic text-xs">Read-only</span>
              }
            </div>
          </td>
        </tr>
      } @empty {
        <tr>
          <td colspan="4" class="px-6 py-10 text-center text-gray-500">No damages recorded yet.</td>
        </tr>
      }
    </tbody>
  </table>

  <!-- Pagination -->
  <div
    class="mt-4 flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 rounded-md"
  >
    <div class="flex flex-1 justify-between sm:hidden">
      <button
        (click)="store.prevDamagesPage()"
        [disabled]="store.damagesOffset() === 0"
        class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"
      >
        Previous
      </button>
      <button
        (click)="store.nextDamagesPage()"
        [disabled]="store.damagesOffset() + store.damagesLimit() >= store.totalDamages()"
        class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"
      >
        Next
      </button>
    </div>
    <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
      <div>
        <p class="text-sm text-gray-700">
          Showing
          <span class="font-medium">{{ store.damagesOffset() + 1 }}</span>
          to
          <span class="font-medium">{{
            Math.min(store.damagesOffset() + store.damagesLimit(), store.totalDamages())
          }}</span>
          of
          <span class="font-medium">{{ store.totalDamages() }}</span>
          results
        </p>
      </div>
      <div>
        <nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
          <button
            (click)="store.prevDamagesPage()"
            [disabled]="store.damagesOffset() === 0"
            class="relative inline-flex items-center rounded-l-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"
          >
            Previous
          </button>
          <button
            (click)="store.nextDamagesPage()"
            [disabled]="store.damagesOffset() + store.damagesLimit() >= store.totalDamages()"
            class="relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"
          >
            Next
          </button>
        </nav>
      </div>
    </div>
  </div>
</div>
